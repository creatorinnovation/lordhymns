import{r,a as d,b as N,j as e,H as S,L as p}from"./app-B2_QvAPB.js";import{M as w}from"./MainLayout-CTSYdz9y.js";import"./Logo-Dal5EXcN.js";const R=({songs:s,filters:o})=>{const[a,g]=r.useState(o.search||""),h=o.sort||"english_title",c=o.direction||"asc",f=()=>{d.get(route("gospel-songs"),{search:a,sort:"english_title",direction:c==="asc"?"desc":"asc"},{preserveState:!0,replace:!0})},b=t=>{t.preventDefault(),d.get(route("gospel-songs"),{search:a,sort:h,direction:c},{preserveState:!0,replace:!0})};r.useEffect(()=>{const t=setTimeout(()=>{d.get(route("gospel-songs"),{search:a},{preserveState:!0,replace:!0})},100);return()=>clearTimeout(t)},[a]);const[j,u]=r.useState(s.data),[n,m]=r.useState(s.next_page_url),l=r.useRef(null),i=r.useRef(!1);return r.useEffect(()=>{u(s.data),m(s.next_page_url)},[s]),r.useEffect(()=>{if(!l.current)return;const t=new IntersectionObserver(async([v])=>{if(v.isIntersecting&&n&&!i.current){i.current=!0;const x=await N.get(n,{headers:{Accept:"application/json"}});u(y=>[...y,...x.data.data]),m(x.data.next_page_url),i.current=!1}});return t.observe(l.current),()=>t.disconnect()},[n]),e.jsxs(w,{children:[e.jsx(S,{title:"Gospel Songs"}),e.jsx("div",{className:"container mx-auto mt-5 mb-5",children:e.jsx(p,{href:route("about"),className:"py-2 px-3 bg-green-200 rounded-md shadow-md",children:"Bookmark"})}),e.jsx("div",{className:"container mx-auto mb-5",children:e.jsxs("div",{className:"flex flex-col justify-between md:flex-row gap-3 items-start md:items-center",children:[e.jsxs("form",{onSubmit:b,className:"flex gap-2 w-full md:w-auto",children:[e.jsx("input",{type:"text",value:a,onChange:t=>g(t.target.value),placeholder:"Search title / artist...",className:"border rounded-lg px-4 py-2 w-full md:w-64"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Search"})]}),e.jsxs("button",{onClick:f,className:"px-4 py-2 border rounded-lg flex items-center gap-2",children:["Sort A–Z",e.jsx("span",{className:"text-sm text-gray-500",children:c==="asc"?"↑":"↓"})]})]})}),e.jsx("div",{className:"container mx-auto",children:j.map(t=>e.jsx(p,{href:route("gospelsong.detail",t.id),children:e.jsx("div",{className:"py-5 px-2 mb-2 shadow-md border hover:bg-gray-100",children:t.english_title})}))}),n&&e.jsx("div",{ref:l,className:"text-center py-6 text-gray-500",children:"Loading more..."}),!n&&e.jsx("p",{className:"text-center text-gray-400 py-4",children:"No more records"})]})};export{R as default};
