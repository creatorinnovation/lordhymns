import{r,a as d,c as N,j as e,H as S,L as x}from"./app-DctKPgBp.js";import{M as w}from"./MainLayout-D05vhtXV.js";import"./NavBar-D0toUJh7.js";import"./LoginModal-DRVk1Ap6.js";import"./Modal-BjR629bu.js";import"./RegisterModal-CD9eQUq8.js";const A=({songs:s,filters:n})=>{const[a,g]=r.useState(n.search||""),h=n.sort||"english_title",c=n.direction||"asc",f=()=>{d.get(route("gospel-songs"),{search:a,sort:"english_title",direction:c==="asc"?"desc":"asc"},{preserveState:!0,replace:!0})},j=t=>{t.preventDefault(),d.get(route("gospel-songs"),{search:a,sort:h,direction:c},{preserveState:!0,replace:!0})};r.useEffect(()=>{const t=setTimeout(()=>{d.get(route("gospel-songs"),{search:a},{preserveState:!0,replace:!0})},100);return()=>clearTimeout(t)},[a]);const[b,u]=r.useState(s.data),[o,m]=r.useState(s.next_page_url),l=r.useRef(null),i=r.useRef(!1);return r.useEffect(()=>{u(s.data),m(s.next_page_url)},[s]),r.useEffect(()=>{if(!l.current)return;const t=new IntersectionObserver(async([v])=>{if(v.isIntersecting&&o&&!i.current){i.current=!0;const p=await N.get(o,{headers:{Accept:"application/json"}});u(y=>[...y,...p.data.data]),m(p.data.next_page_url),i.current=!1}});return t.observe(l.current),()=>t.disconnect()},[o]),e.jsxs(w,{children:[e.jsx(S,{title:"Gospel Songs"}),e.jsx("div",{className:"container mx-auto mt-5 mb-5",children:e.jsx(x,{href:route("about"),className:"py-2 px-3 bg-green-200 rounded-md shadow-md",children:"Bookmark"})}),e.jsx("div",{className:"container mx-auto mb-5",children:e.jsxs("div",{className:"flex flex-col justify-between md:flex-row gap-3 items-start md:items-center",children:[e.jsxs("form",{onSubmit:j,className:"flex gap-2 w-full md:w-auto",children:[e.jsx("input",{type:"text",value:a,onChange:t=>g(t.target.value),placeholder:"Search title / artist...",className:"border rounded-lg px-4 py-2 w-full md:w-64"}),e.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg",children:"Search"})]}),e.jsxs("button",{onClick:f,className:"px-4 py-2 border rounded-lg flex items-center gap-2",children:["Sort A–Z",e.jsx("span",{className:"text-sm text-gray-500",children:c==="asc"?"↑":"↓"})]})]})}),e.jsx("div",{className:"container mx-auto",children:b.map(t=>e.jsx(x,{href:route("gospelsong.detail",t.id),children:e.jsx("div",{className:"py-5 px-2 mb-2 shadow-md border hover:bg-gray-100",children:t.english_title})}))}),o&&e.jsx("div",{ref:l,className:"text-center py-6 text-gray-500",children:"Loading more..."}),!o&&e.jsx("p",{className:"text-center text-gray-400 py-4",children:"No more records"})]})};export{A as default};
